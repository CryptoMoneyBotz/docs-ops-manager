---
title: Overview of Certificate Rotation
owner: Ops Manager
---

This topic describes how to check the expiration date of and rotate certificate authorities (CAs) and leaf certificates in <%= vars.platform_name %>.

This includes the <%= vars.ops_manager %> root CA, BOSH NATS CA, BOSH DNS CA, the Diego root CA, and other CAs and leaf certificates stored in <%= vars.ops_manager %> and CredHub that are visible to the <%= vars.ops_manager %> API.

<p class='note warning'><strong>Warning:</strong> The rotation procedures described in this topic do not work if the certificates have already expired. If the certificates have expired, contact <%= vars.support_link %> for guidance.</p>

For information about rotating IPsec certificates, see [Rotating IPsec Certificates](https://docs.pivotal.io/addon-ipsec/credentials.html).

For information about using trusted third-party certificates for both apps hosted on <%= vars.platform_name %> and internal <%= vars.platform_name %> components, see [Setting Trusted Certificates](https://docs.pivotal.io/platform/<%= product_info['local_product_version'].to_s.sub('.','-') %>/customizing/trusted-certificates.html).

For information about how to rotate certificates managed by CredHub, including the Services TLS CA (`/services/tls_ca`), see [Advanced Certificate Rotation with CredHub Maestro](advanced-certificate-rotation.html).


## <a id='overview'></a> Overview

The <%= vars.ops_manager %> API manages and lists internal CAs and leaf certificates that enable <%= vars.platform_name %> components to communicate with each other securely using TLS. It can also list certificates used externally, such as SAML certificates that authenticate to an external identity provider (IDP).

For more information about the CAs and leaf certificates visible to the <%= vars.ops_manager %> API, see [Certificate Types](certificate-types.html).

Rotate CAs and leaf certificates before they expire to avoid downtime for your foundation. To rotate certificates in <%= vars.platform_name %>, first check the expiration dates of all certificates. Then, based on the types of certificates that expire soon, follow a certificate rotation procedure to replace expiring certificates and deploy BOSH to apply changes.


## <a id='prerequisite'></a> Prerequisites

Before you rotate certificates in <%= vars.ops_manager %> v2.9:

* You must reset any certificates that were manually set in CredHub on <%= vars.ops_manager %> v2.6 and earlier to prevent them from being rotated with other certificates generated by CredHub. To find and reset any manually set certificates in CredHub, see [Reviewing Manually Set Certificates in CredHub](manual-credhub-certificate.html).

* You must have both <%= vars.ops_manager %> v2.9 and <%= vars.app_runtime_full %> (<%= vars.app_runtime_abbr %>) v2.9 or later to rotate CredHub-managed certificates with this procedure. If you have a version of <%= vars.app_runtime_abbr %> earlier than v2.9, you can follow this procedure to rotate certificates managed by <%= vars.ops_manager %>. Then, to rotate certificates managed in CredHub, see [Advanced Certificate Rotation with CredHub Maestro](advanced-certificate-rotation.html).

* You cannot have <%= vars.k8s_runtime_full %> (<%= vars.k8s_runtime_abbr %>) installed to rotate CredHub-managed certificates with this procedure. If you have <%= vars.k8s_runtime_abbr %>, you can follow this procedure to rotate certificates managed by <%= vars.ops_manager %>. Then, to rotate certificates managed in CredHub, see [Advanced Certificate Rotation with CredHub Maestro](advanced-certificate-rotation.html).


## <a id='rotate'></a> Rotate Certificates

This section explains how to rotate certificates in <%= vars.platform_name %>, including the <%= vars.ops_manager %> root CA, BOSH NATS CA, CAs stored in CredHub, and leaf certificates. There are different rotation procedures for each type of certificate that requires rotation.

You can determine which rotation procedure to follow based on the types of certificates in your foundation that must be rotated.

<p class='note warning'><strong>Warning:</strong> The rotation procedures described in this topic do not work if the certificates have already expired. If the certificates have expired, contact <%= vars.support_link %> for guidance.</p>

To rotate certificates, follow one of these procedures:

* To rotate non-rotatable certificates, contact <%= vars.support_link %>.

* To rotate CAs and leaf certificates stored in <%= vars.ops_manager %> and CredHub, see [Rotating CAs and Leaf Certificates](rotate-cas-and-leaf-certs.html). This procedure also rotates the BOSH NATS CA.

* To rotate non-configurable leaf certificates, but not the <%= vars.ops_manager %> root CA or BOSH NATS CA, see [Rotating Non-Configurable Leaf Certificates](rotate-non-configurable-certs.html).

* To rotate configurable leaf certificates, but not the <%= vars.ops_manager %> root CA or BOSH NATS CA, see [Rotating Configurable Leaf Certificates](rotate-configurable-certs.html).
